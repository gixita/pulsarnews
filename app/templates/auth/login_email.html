{% extends "core.html" %}

{% block content %}
<script src="https://statics.teams.cdn.office.net/sdk/v1.5.2/js/MicrosoftTeams.min.js" crossorigin="anonymous"></script>
    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.17/js/adal.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
        microsoftTeams.initialize();
        microsoftTeams.authentication.authenticate({
    url: window.location.origin + "/auth/login_azure",
    width: 600,
    height: 535,
    successCallback: function (result) {
        getUserProfile(result.accessToken);
    },
    failureCallback: function (reason) {
        handleAuthError(reason);
    }
});
        
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        };
    </script>

<div class="container">
    <div class="d-flex justify-content-center align-items-center" style="height: 100vh">
        <div class="text-center">
            <a href="{{ url_for('main.index', subdomain=subdomain) }}">
                <img
                class="mb-4"
                src="{{ url_for('static', filename='pulsarnews.png')}}"
                style="width: 250px;"
                />
            </a>
            <!-- <h5 class="mb-3">Connect</h5> -->
            <form action="" method="post" novalidate>
                {{ form.hidden_tag() }}
                <p>
                    {{ form.email(class="form-control form-control-lg", size=32, placeholder="Email") }}<br>
                    {% for error in form.email.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </p>
                <button class="btn btn-primary btn-lg" type="submit">Next</button>
            </form>
            <a href="{{ url_for('auth.register', subdomain=subdomain) }}">No account yet ?</a><br>
            <a href="{{ url_for('auth.login_azure', subdomain=subdomain) }}">Login with Azure</a><br>
            
            {% for arg in args %}
<p>{{ arg  }}</p>
{% endfor %}
        </div>
    </div>
</div>

{% endblock %}
